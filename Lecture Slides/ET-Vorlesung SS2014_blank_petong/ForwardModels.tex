% !TEX root = EnergyTrading_ss14UDE.tex
\section{Forward Models}
\subsection{Basic Pricing Relations for Forwards/Futures}

% frametitle
{Storage, Inventory and Convenience Yield}
\begin{itemize}
\item<1-> The theory of storage aims to explain the differences between spot
and Futures (Forward) prices by analyzing why agents hold inventories.
\item<2-> Inventories
allow to meet unexpected demand, avoid the cost of frequent revisions in
the production schedule and eliminate manufacturing disruption.
\item<3-> This
motivates the concept of convenience yield as a benefit, that accrues to the
owner of the physical commodity but not to the holder of a forward contract.
\item<4-> Thus the convenience yield is comparable to the dividend yield for stocks.
\item<5-> A modern view is to view storage (inventory) as a timing option, that
allows to put the commodity to the market when prices are high
and hold it when the prices are low.
\end{itemize}

% frametitle
{Spot-Forward Relationship in Commodity Markets }
Under the no-arbitrage assumption we have
\begin{equation}\label{SF-rel}
F(t,T)=S(t)e^{(r-y)(T-t)}
\end{equation}
where $r$ is the interest rate at time $t$ for maturity $T$ and $y$ is the convenience yield.

% frametitle
{Spot-Forward Relationship in Commodity Markets }

Observe that (\ref{SF-rel}) implies
\begin{itemize}
\item<1-> spot and forward are redundant (one can replace the other) and form a
linear relationship (unlike options)
\item<2-> with two forward prices we can derive the value of $S(t)$ and $y$
\item<3-> knowledge of $S(t)$ and $y$ allows us to construct the whole forward curve
\item<4-> for $r-y <0$ we have backwardation; for $r-y>0$ we have contango.
\end{itemize}

% frametitle
{Spot-Forward Relationship: Classical theory}
\begin{itemize}
\item<1-> In a stochastic model we use
$$
F(t,T)=\EX_{\Q}[S(T)|\F_t]
$$
where $\F_t$ is the accumulated available market information (in most models the information generated by the spot price).
\item<2-> $\Q$ is a risk-neutral probability
\begin{itemize}
\item discounted spot price is a $\Q$-martingale
\item fixed by calibration to market prices or a market price of risk argument
\end{itemize}
\end{itemize}

% frametitle
{Forward Prices and Expectation of Future Spot Prices}
The rational expectation hypothesis (REH) states that the current forward price $F(t,T)$ for a commodity with
delivery a time $T>t$ is the best estimator for the price $S(T)$ of the commodity.
In mathematical terms
\begin{equation}\label{REH}
F(t,T) = \EX_\prb[S(T) |\F_t].
\end{equation}
where $\F_t$ represents the information available at time $t$. The REH has been statistically
tested in many studies for a wide range of commodities.

% frametitle
{Futures Prices and Expectation of Future Spot Prices}
When equality in (\ref{REH}) does not hold forward prices are biased estimators of
future spot prices. If
\begin{itemize}
\item[$>$] holds, then $F(t,T)$ is an up-ward biased estimate, then risk-aversion
among market participants is such that buyers are willing to pay more than the expected
spot price in order to secure access to the commodity at time $T$ (political unrest);
\item[$<$] holds, then $F(t,T)$ is an down-ward biased estimate, this may reflect a
perception of excess supply in the future.
\end{itemize}

% frametitle
{Market Risk Premium}
\begin{itemize}
\item<1-> The \emph{market risk premium} or \emph{forward bias} $\pi (t,T)$
relates forward and expected spot prices.
\item<2-> It is defined as the difference, calculated at time $t$, between
the forward $F(t,T)$ at time $t$ with delivery at $T$ and expected
spot price:
\begin{equation}\label{forward risk premium}
\pi(t,T)= F(t,T)-\EX_\prb[S(T)| \F_t].
\end{equation}
Here $\EX_\prb$ is the expectation operator, under the
historical measure $\prb$, with information up until time $t$ and
$S(T)$ is the spot price at time $T$.
\end{itemize}

\subsection{HJM-type models}

% frametitle
{ Heath-Jarrow-Morton (HJM) model}

The Heath-Jarrow-Morton model uses the entire forward rate curve as
(infinite-dimensional) state variable. The dynamics of the forward rates $F(t,T)$ are {\it exogenously} given by
$$
%\label{forward rate dynamics}
dF(t,T) = \alpha(t,T) dt + \s(t,T) dW(t).
$$
For any fixed maturity $T$, the
initial condition of the stochastic differential equation
is determined by the current value
of the empirical (observed) forward rate for the future date $T$
which prevails at time $0$.

% frametitle
{One-Factor GBM Specification}
Here the volatility is
$$
\sigma_1(t,T)=e^{-\kappa (T-t)}\sigma
$$
and
$$
dF(t,T)=F(t,T)\sigma_1(t,T)dW(t)
$$

% frametitle
{Two-Factor GBM Specification}
Here the volatilities are
$$
\sigma_1(t,T)=e^{-\kappa (T-t)}\sigma_1 \; \mbox{ and } \; \sigma_2>0
$$
and
$$
\frac{dF(t,T)}{F(t,T)}=\sigma_1(t,T)dW_1(t)+\sigma_2dW_2(t)
$$

\subsection{A Market Model}

% frametitle
{Modelling Approach}
\begin{itemize}
\item<1-> We use the HJM-framework to model the forward dynamics directly.
\item<2-> We distinguish between forward contracts with a fixed time delivery and forward contracts with a delivery period, called \emph{swaps}.
\item<3-> Since the HJM-framework cannot be applied to the swap dynamics literally, we differentiate between the \emph{decomposable} swaps and the \emph{atomic} swaps and apply the framework to the atomic swaps.
\end{itemize}

% frametitle
{Modelling Approach}
The dynamics of a decomposable swap with delivery period $[T_1,T_{N}]$ can than be obtained from $N-1$ atomic swaps by
\begin{align}
F(t,T_1,T_N)=\sum\limits_{i=1}^{N-1} \frac{T_{i+1}-T_i}{T_N-T_1} F(t,T_i,T_{i+1})\label{eqn: decomposbale swap}
\end{align}

% frametitle
{Modelling Approach}
We discuss several lognormal dynamics of the swap price,
\begin{equation}
dF(t,T_1,T_2)=\Sigma(t,T_1,T_2)F(t,T_1,T_2)\, dW(t). \label{eqn: lognormal dynamics}
\end{equation}
The only parameter in this model is the volatility function $\Sigma$ which has to capture all movements of the swap price and especially the time to maturity effect.

% frametitle
{Volatility Functions}
We assume that the swap price dynamics \emph{for all atomic swaps} is given by (\ref{eqn: lognormal dynamics})
where $\Sigma(t,T_1,T_2)$ is a continuously differentiable and positive function.

Starting out with a given volatility function for a fixed time forward contract we see that the volatility function $\Sigma$ for the swap contract is given by
\begin{equation}
\Sigma(t,T_1,T_2)=\int_{T_1}^{T_2} \hat{w}(u,T_1,T_2) \sigma(t,u) \, du. \label{eqn: swap volatility creation}
\end{equation}

% frametitle
{Schwartz}
For the volatility function of the forward we use
\begin{equation}\label{vol-schwartz}
\sigma(t,u)=a e^{-b(u-t)}
\end{equation}
where $a,b >0 $ are constant.

% frametitle
{Schwartz}
The time to maturity effect is modeled by a negative exponential function.
\begin{itemize}
\item<1-> When the time to maturity tends to infinity the volatility function converges to zero.
\item<2-> The exponential function causes that the volatility increases as the time to maturity decreases which leads to an increased volatility when the contract approaches the maturity.
\end{itemize}

% frametitle
{Schwartz}

Applying this forward volatility to (\ref{eqn: swap volatility creation}) the swap volatility is:
\begin{align}
\Sigma(t,T_1,T_2)&=a\,\varphi(T_1,T_2)
\end{align}
where
\begin{align}
\varphi(T_1,T_2)= \frac{e^{-b(T_1-t)}-e^{-b(T_2-t)}}{b(T_2-T_1)}
\label{volatility function varphi}
\end{align}
The Black-76 specification of the forward volatility can be obtained if $\varphi(T_1,T_2) =1$, that is $b=0$
in (\ref{vol-schwartz}).

The associated swap price volatility is then given by $\Sigma(t,T_1,T_2)=a$.

% frametitle
{Fackler-Tian}
\emph{Fackler and Tian}  replaced the factor $a$ by a seasonality function $a(t)$.
\begin{equation}
\sigma(t,u) = a(t)e^{-b(u-t)}
\end{equation}
where $a(t)$ is a seasonality function modeled by
\begin{equation}
a(t)=a+\sum_{j=1}^{7}(\alpha_j\, \cos(2\pi jt)+ \beta_j \, sin(2\pi jt)) \label{seasonality function}
\end{equation}
with $t$  measured in years. The parameters $\alpha_j$ and $\beta_j$ are real numbers and $a \ge 0, b > 0$.

% frametitle
{Fackler-Tian}

The volatility function of the swap price is therefore
\begin{equation}
\Sigma(t,T_1,T_2)=a(t)\, \varphi(T_1,T_2)
\end{equation}
where $\varphi(T_1,T_2)$ is given by (\ref{volatility function varphi}).\\

% frametitle
{Clewlow - Strickland}
\begin{itemize}
\item<1-> Empirical observations show that in energy markets we can observe that the volatility increases strictly as the contract approaches maturity.
\item<2-> Such a sharp raise can be modeled by a high value for $b$.
\item<3-> The drawback of a high value for $b$ is that for contracts with long time to maturity the volatility decreases fast and thus becomes very small.
\end{itemize}

% frametitle
{Clewlow - Strickland}

For this reason \emph{Clewlow and Strickland} suggested
\begin{equation}
\sigma(t,u)=a((1-c)e^{-b(u-t)}+c) \label{Strickland model}
\end{equation}
where $a\ge 0, b > 0$ and $ 0 \le c\le 1$.

% frametitle
{Clewlow - Strickland}

The associated swap volatility model becomes
\begin{equation}
\Sigma(t,T_1,T_2)=a((1-c)\,\varphi(T_1,T_2)+c)
\end{equation}
where $\varphi(T_1,T_2)$ is defined as in (\ref{volatility function varphi}).\\

% frametitle
{Koekenbakker -- Lien}
\emph{Koekenbakker and Lien} suggested to use a seasonality function in the \emph{Strickland} model (\ref{Strickland model}) and proposed a volatility which is given by
\begin{equation}
\sigma(t,u)=a(t)\, ((1-c)e^{-b(u-t)}+c)
\end{equation}
where $a(t)$ is defined as in (\ref{seasonality function}) and with parameters $a \ge 0, b > 0\, ,\, 0 \le c \le 1, \,\alpha_j, \, \beta_j$ are real constants.

% frametitle
{Koekenbakker -- Lien}
\begin{itemize}
\item<1-> Observe that $\lim \limits_{u \to t} \sigma(t,u)$ exists and $\sigma(t,t)=a(t)$.
\item<2-> Hence the spot volatility is modeled by the seasonal function.
\item<3-> As $u$ approaches infinity we obtain that $\sigma(t,u)=a(t)c$.
\item<4-> Thus, the volatility is bounded within the interval $[a(t)c, a(t)]$, where $ca(t) \le a(t)$, since $0 \le c \le 1$.\\
\end{itemize}

% frametitle
{Koekenbakker -- Lien}
We obtain the swap volatility model
\begin{equation}
\Sigma(t,T_1,T_2)=a(t) ((1-c)\, \varphi(T_1,T_2)+c).
\end{equation}

% frametitle
{Benth -- Koekenbakker}
\emph{Benth and Koekebakker} suggested the following forward curve model
\begin{equation}
\sigma(t,u)=\hat{a} e^{-b(u-t)}+a(t)
\end{equation}
where $\hat{a} \ge 0, b>0$ and $a(t)$ is given by (\ref{seasonality function}).

In this model the seasonality effect is separated from the maturity effect. For the short term volatility we have $\hat{a}+a(t)$ and for the long term volatility we obtain $a(t)$.

% frametitle
{Benth -- Koekenbakker}

The associated swap volatility is given by
\begin{equation}
\Sigma(t,T_1,T_2)=\hat{a}\, \varphi(T_1,T_2) +a(t).
\end{equation}

% frametitle
{Model Summary}
A summary of the different models  is listed in Table \ref{tab: lognormal models}.
\begin{table}[h]
 \small \centering {\sf
\begin{tabular}[t]{l|c}
        Model & $\Sigma(t,T_1,T_2)$ \\ %\toprule
       Black-76 & $a$ \\
        Schwartz  &$a\, \varphi(T_1,T_2)$  \\
        Fackler and Tien  & $a(t)\, \varphi(T_1,T_2)$ \\
        Clewlow and Strickland & $a((1-c)\, \varphi(T_1,T_2)+c)$ \\
        Koekebakker and Lien  & $a(t)((1-c)\, \varphi(T_1,T_2)+c)$ \\
        Benth and Koekebakker& $\hat{a}\, \varphi(T_1,T_2) +a(t)$ \\

    \end{tabular}}
    \caption[Swap Volatility Models]
    {\small The associated swap volatility models generated by (\ref{eqn: swap volatility creation}) with $a \ge 0, b > 0$ and $0 \le c \le 1$ constants, $a(t)$ defined in (\ref{seasonality function}) and $\varphi(T_1,T_2)$ is given by (\ref{volatility function varphi}). }
    \label{tab: lognormal models}
\end{table}

