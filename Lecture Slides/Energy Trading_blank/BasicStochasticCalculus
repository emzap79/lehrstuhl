% !TEX root = EnergyTrading_ss13UDE.tex
\section{Stochastic Processes for Price Movements}

\subsection{How to Model Price Movements?}

\frame{\frametitle{Stock Price Return}
\begin{itemize}
\item<1-> We wish to model the time evolution of a stock price
$S(t)$ and consider how $S$
will change in some small time-interval from the present time $t$
to a time $t+dt$ in the near future.
\item<2-> Writing $dS(t)$ for the
change $S(t+dt)-S(t)$ in $S$, the {\it return} on $S$ in this
interval is $dS(t)/S(t)$.
We decompose the return into two components, a {\it systematic}
part and a {\it random} part.
\item<3-> The systematic is modelled by $\mu dt$, where $\mu$ is some parameter
representing the mean rate of return of the stock.
\item<4->
The random part is modelled by $\sigma dW(t)$, where $dW(t)$
represents the stochastic noise term driving the stock price dynamics, and
$\sigma$ is a second parameter describing how much the stock price fluctuates. Thus $\sigma$
governs how volatile the price is, and is called the {\it
volatility} of the
stock.
\end{itemize}
}



\frame{\frametitle{Geometric Brownian Motion}

Putting this together, we have the stochastic differential
equation (SDE)
\begin{equation}\label{GBM}
dS(t) = S(t) (\mu dt + \sigma dW(t)), \A S(0) > 0,
\end{equation}
due to It\^{o} in 1944.\\*[12pt]

The economic importance of geometric
Brownian motion was recognised by Paul A. Samuelson in his work, for which Samuelson received the Nobel
Prize in Economics in 1970, and by Robert Merton, in work for which he was similarly
honoured in 1997.
}


\frame{\frametitle{Brownian Motion I}
\begin{itemize}
\item<1-> For the random noise we use Brownian Motion (introduced by the Botanist Robert Brown in
1828. It was introduced into finance by Louis Bachelier in 1900, and developed in physics by Albert Einstein in 1905.
A mathematical theory was developed by Norbert Wiener)
A stochastic process $X=(X(t))_{t \geq 0}$ is a standard
Brownian motion, $BM$, if
\item[(i)] $X(0) = 0$ a.s., \item[(ii)] $X$ has {\it independent
increments}: $X(t+u) - X(t)$ is independent of $\s (X(s): s \leq
t)$ for $u \geq 0$, \item[(iii)]  $X$ has {\it stationary
increments}: the law of $X(t+u) - X(t)$ depends only on $u$,
\end{itemize}
and (iv), (v)
}


\frame{\frametitle{Brownian Motion II}

A stochastic process $X=(X(t))_{t \geq 0}$ is a standard
Brownian motion, $BM$, if (i) -- (iii) and
\begin{itemize}
\item[(iv)]  $X$ has {\it Gaussian increments}: $X(t+u) - X(t)$ is
normally distributed with mean $0$ and variance $u$, $X(t+u) -
X(t) \sim N(0,u)$, \item[(v)]  $X$ has {\it continuous paths}:
$X(t)$ is a continuous function of $t$.
\end{itemize}
}




\subsection{Basic Stochastic Calculus}



\frame{\frametitle{ It{\^o} Processes}
\begin{itemize}
\item<1-> We will use the following type of process expressed
in terms of the stochastic differential equation
$$
dX(t) = b(t) dt + \s(t) dW(t), \A X(0) = x_0.
$$
\item<2-> For functions $f$ we want to give  meaning to the stochastic differential
$df(X(t))$ of the process $f(X(t))$.
\item<3-> This is done by the {\it It{\^o} Formula}
$$
\begin{array}{lll}
df(X(t)) &=& f'(X(t)) dX(t)\\*[12pt]
&& \DSE+ \frac{1}{2} f''(X(t)) \sigma^2 dt.
\end{array}
$$
\end{itemize}
}


\frame{\frametitle{Multiplication rules}
\begin{itemize}
\item<1-> The second term above corrects for special path properties of
Brownian Motion and needs the quadratic variation of the process.
\item<2-> We find
$$
\begin{array}{lll}
(d X)^2 &=&\DSE (b dt + \s dW)^2 \\*[12pt]
&=&\DSE \s^2 dt + 2 b \s dt dW + b^2 (dt)^2 = \s^2 dt.
\end{array}
$$
\item<3-> The quadratic variation of any It{\^o} process can be calculated
using the multiplication rules\\
\begin{center}
\begin{tabular}{|l|ll|}
\hline
& dt &dW \\\hline
dt& 0 & 0\\
dW & 0 &dt \\\hline
\end{tabular}
\end{center}
\end{itemize}


}
\frame{\frametitle{ General It{\^o} Formula}

If $X(t)$ is an It{\^o} process  and $f(t,x)$ a function with time and location variable, then
$f = f(t,X(t))$ has stochastic differential
$$
df = \left(f_t + b f_x + \frac{1}{2} \s^2 f_{xx}\right) dt + \s
f_x dW.
$$
Observe, that we left out all function arguments
}


\frame{\frametitle{ Example: Geometric Brownian Motion}

The SDE for GBM has the unique
solution
$$
S(t) = S(0) \exp \left\{\left(\mu - \frac{1}{2}\sigma^2\right)t +
\sigma W(t) \right\}\!.
$$
Therefore, writing
$$
f(t,x) := \exp\left\{\left(\mu - \frac{1}{2}\sigma^2\right)t +
\sigma x \right\}\!,
$$
we have
$$
f_t = \left(\mu - \frac{1}{2}\sigma^2\right)f, \A f_x = \sigma f,
\A f_{xx} = \sigma^2 f,
$$
and with $x = W(t)$, one has
$$
dx = dW(t), \A (dx)^2 = dt.
$$
}


\frame{\frametitle{ Example: GBM}


Thus It\^{o}'s lemma gives
$$
\begin{array}{lll}
\DSE df &=&\DSE f_t dt + f_x dW + \frac{1}{2} f_{xx}
(dW)^2\\*[12pt] &=&\DSE f\left(\left(\mu -
\frac{1}{2}{\sigma}^2\right) dt + \sigma dW +
\frac{1}{2}{\sigma}^2 dt\right)\\*[12pt] &=&\DSE f(\mu dt + \sigma
dW).
\end{array}
$$
}

\frame{\frametitle{Pricing Derivatives: Risk-Neutral Valuation}
\begin{itemize}
\item<1-> A financial derivative is a function $f(S_T)$ of some underlying stock (or other financial asset) and as such a random variable.
\item<2-> In a standard financial market model we can calculate the price of a derivative with the the risk-neutral valuation
formula
$$
\Pi(0) = e^{-rT}\EX^*\left[f(S(T))\right],
$$
where $r$ is the interest rate and
\item<3-> a special probability measure (or distribution for the underlying) has been used.
\end{itemize}
}

\frame{\frametitle{ Black-Scholes Model}

The classical Black-Scholes model is
$$
\begin{array}{llll}
dB(t) &=&\DSE r B(t) dt, \A &B(0)= 1,\\ dS(t) &=&\DSE S(t) \left(
b dt + \sigma dW(t) \right)\!, \A &S(0) = p,
\end{array}
$$
with constant coefficients $b \in \setR,\; r,\s \in \setR_+$.

}


\frame{\frametitle{Pricing a European Call}

For a European call $C(T) = (S(T)-K)^+$ and  we can evaluate the
above expected value to obtain its Black-Scholes price
pro\-cess
$$
\begin{array}{lll}
C(t) &=&\DSE S(t) \Phi(d_1(S(t), T-t))\\*[12pt]
&&- K e^{-r(T-t)} \Phi(d_2(S(t), T-t)).
\end{array}
$$
The functions $d_1(s,t)$ and $d_2(s,t)$ are given by
$$
\begin{array}{lll}
d_1(s,t) &=&\DSE \frac{\log(s/K) + (r +
\frac{\sigma^2}{2})t}{\sigma \sqrt{t}},\\*[12pt] d_2(s,t) &=&\DSE
 \frac{\log(s/K) + (r -
\frac{\sigma^2}{2})t}{\sigma \sqrt{t}}
\end{array}
$$
}
\subsection[Mean-Reversion Model]{A Mean-Reversion Diffusion Model}


\frame{\frametitle{Definition of the model}
We assume a simple market model in which the price of the underlying commodity, $S_t$, follows a stochastic process which can be described as follows:
Let $X_t = \ln S_t$ and
\begin{align*}
	dX_t = \kappa (\ln \theta - X_t)dt + \sigma dW_t~~,~~X_0 = \ln(S_0)
\end{align*}
Thus, the logarithm of the prices follow a mean reverting diffusion process, the so-called \textcolor{red}{Ornstein-Uhlenbeck-Process}.\\
\begin{itemize}
\item $\kappa$ - Speed of mean reversion
\item $\theta$ - Level of mean reversion
\item $\sigma$ - Volatility of the process
\item $dW_t$ - Brownian increments
\end{itemize}
}

\frame{\frametitle{Sample paths of the model}
We simulate $S_t$ (with $S_0=20, \theta = 20, \kappa = 1, \sigma = 0.2$) and get sample paths
\begin{figure}
	\centering
		\includegraphics[width=1.00\textwidth]{../../../pics/samplepaths.png}
	\label{fig:samplepahts}
\end{figure}
}



\frame{\frametitle{Properties of the model}
\begin{itemize}
\item<1-> Mean reverting
\item<2-> Bounded volatility
\item<3-> Continuous paths
\item<4-> Relative price changes are normally distributed
\item<5-> \textcolor{red}{Analytic results} for the forward-curve and option prices exist
\item<6-> \textcolor{red}{Calibration} easily possible
\end{itemize}
}

\frame{\frametitle{Spot prices in the model}
The spot price at any time $t$ is
\begin{align*}
	S_t = \exp \left( e^{-\kappa t} \ln S_0 + (1-e^{-\kappa t}) \ln \theta + \int_0^t{\sigma e^{-\kappa (t-s)}}dW_s \right).
\end{align*}
}

\frame{\frametitle{Forward prices in the model}
Using that the forward price is the expected value of future spot prices,
$F(t,T) = \EX^{Q}[S_T | \Ft]$,
we get the formula for the forward price at time $t$ for the forward expiring in $T$ as
\begin{align*}
	&F(t,T) = \\
	&\exp \left( e^{-\kappa(T-t)} \ln S_t + (1-e^{-\kappa(T-t)}) \ln \theta + \frac{\sigma^2}{4\kappa}(1-e^{-2\kappa(T-t)}) \right).
\end{align*}
We can see that the forward prices converge to the spot price with time to maturity tending to zero.
}

\frame{\frametitle{Forward curves in the model}
Assuming the same parameters as before and varying $S_t$ we get the forward curves:
\begin{figure}
	\centering
		\includegraphics[width=1.00\textwidth]{../../../pics/forwardcurves.png}
	\label{fig:forwardcurves}
\end{figure}
}

\frame{\frametitle{Properties of the forward curve in the model}
\begin{itemize}
\item<1-> $F(t,T) \rightarrow \exp(\ln \theta + \frac{\sigma^2}{4 \kappa}) = \theta \exp{(\frac{\sigma^2}{4\kappa})}$ as $T \rightarrow \infty$.
\item<2-> If the spot price is low compared to the long term mean, the forward curve is upward sloping (contango).
\item<3-> If the spot price is high compared to the long term mean, the forward curve is downward sloping (backwardation).
\item<4-> If the spot price is close to the long term mean, the forward curve might be humped-shaped.
\end{itemize}
}

